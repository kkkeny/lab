<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />

        <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
        Remove this if you use the .htaccess -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

        <title>index</title>
        <meta name="description" content="" />
        <meta name="author" content="尹和健" />

        <meta name="viewport" content="width=device-width; initial-scale=1.0" />
        <style type="text/css">
            section.compass {
                height: 440px;
                background: url(compass.png) center center no-repeat;
                background-size: contain;
                margin: 0 auto;
            }
        </style>
    </head>

    <body>
        <section class="compass"></section>
        <h1 id="alpha"></h1>
        <h1 id="beta"></h1>
        <h1 id="gamma"></h1>
        <h1 id="dir"></h1>
        <script type="text/javascript">
            if (!window.DeviceOrientationEvent)
            {
                alert("该换手机了")
            }
            else
            {
                window.addEventListener("compassneedscalibration", function()
                {
                    alert("需要画八字");
                }, true);
                window.addEventListener("deviceorientation", function(event)
                {
                    console.log(event);
                    // process event.alpha, event.beta and event.gamma
                    var alpha = document.getElementById("alpha");
                    var beta = document.getElementById("beta");
                    var gamma = document.getElementById("gamma");
                    var panel = document.querySelector("section.compass");
                    panel.style.WebkitTransform = "rotate(" + (parseInt(event.alpha) - 360+15) + "deg)";
                    alpha.innerText = "alpha: " + parseInt(event.alpha);
                    beta.innerText = "beta: " + parseInt(event.beta);
                    gamma.innerText = "gamma: " + parseInt(event.gamma);
                }, true);
                window.addEventListener("orientationchange", function()
                {
                    location.reload();
                }, true);
            }
        </script>
    </body>
</html>